{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { oneChecked } from '../validators/minDays.validator';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/restaurant-service.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nfunction RestaurantFormComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Name is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Name can only contain letters and spaces. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Description is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Cuisine is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵelement(1, \"input\", 20);\n    i0.ɵɵelementStart(2, \"label\", 21);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const day_r11 = ctx.$implicit;\n    const i_r12 = ctx.index;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"checkDay\", i_r12, \"\");\n    i0.ɵɵproperty(\"formControlName\", i_r12)(\"ngClass\", ctx_r4.validClasses(ctx_r4.daysControl, \"is-valid\", \"is-invalid\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"for\", \"checkDay\", i_r12, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(day_r11);\n  }\n}\nfunction RestaurantFormComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵtext(1, \" A minimum of one day is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Phone is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Phone must have 9 numbers. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RestaurantFormComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \" Image is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"d-none\": a0\n  };\n};\nfunction RestaurantFormComponent_img_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 23);\n  }\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, !ctx_r10.newRestaurant.image))(\"src\", ctx_r10.newRestaurant.image, i0.ɵɵsanitizeUrl);\n  }\n}\nexport class RestaurantFormComponent {\n  constructor(restaurantService, router, fb) {\n    this.restaurantService = restaurantService;\n    this.router = router;\n    this.fb = fb;\n    this.add = new EventEmitter();\n    this.newRestaurant = {\n      name: \"\",\n      image: \"\",\n      cuisine: \"\",\n      description: \"\",\n      phone: \"\",\n      daysOpen: []\n    };\n    this.imageName = '';\n    this.days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n    this.saved = false;\n  }\n  ngOnInit() {\n    this.nameControl = this.fb.control('', [Validators.required, Validators.pattern('^[a-zA-Z][a-zA-Z ]*$')]);\n    this.descriptionControl = this.fb.control('', [Validators.required]);\n    this.cuisineControl = this.fb.control('', [Validators.required]);\n    this.daysControl = this.fb.array(new Array(7).fill(true), [oneChecked()]);\n    this.phoneControl = this.fb.control('', [Validators.required, Validators.pattern('([+0]?[0-9]{2} ?)?[0-9]{9}')]);\n    this.imageControl = this.fb.control('', [Validators.required]);\n    this.formRestaurant = this.fb.group({\n      name: this.nameControl,\n      description: this.descriptionControl,\n      cuisine: this.cuisineControl,\n      days: this.daysControl,\n      phone: this.phoneControl,\n      image: this.imageControl\n    });\n  }\n  canDeactivate() {\n    return this.saved || this.formRestaurant.pristine || confirm('Do you want to leave this page?. Changes can be lost');\n  }\n  changeImage(fileInput) {\n    if (!fileInput.files || fileInput.files.length === 0) {\n      return;\n    }\n    const reader = new FileReader();\n    reader.readAsDataURL(fileInput.files[0]);\n    reader.addEventListener('loadend', () => {\n      this.newRestaurant.image = reader.result;\n    });\n  }\n  fillDays(daysOpen) {\n    const result = [];\n    for (let i = 0; i < daysOpen.length; i++) {\n      if (daysOpen[i]) {\n        result.push(i.toString());\n      }\n    }\n    return result;\n  }\n  addRestaurant() {\n    this.newRestaurant.name = this.nameControl.value;\n    this.newRestaurant.description = this.descriptionControl.value;\n    this.newRestaurant.cuisine = this.cuisineControl.value;\n    this.newRestaurant.daysOpen = this.fillDays(this.daysControl.value);\n    this.newRestaurant.phone = this.phoneControl.value;\n    this.restaurantService.addRestaurant(this.newRestaurant).subscribe({\n      next: () => {\n        this.saved = true;\n        this.imageName = '';\n        this.router.navigate(['/restaurant']);\n      },\n      error: e => console.error(e)\n    });\n  }\n  validClasses(control, validClass, errorClass) {\n    return {\n      [validClass]: control.touched && control.valid,\n      [errorClass]: control.touched && control.invalid\n    };\n  }\n  static #_ = this.ɵfac = function RestaurantFormComponent_Factory(t) {\n    return new (t || RestaurantFormComponent)(i0.ɵɵdirectiveInject(i1.RestaurantsService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.NonNullableFormBuilder));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: RestaurantFormComponent,\n    selectors: [[\"fs-restaurant-form\"]],\n    outputs: {\n      add: \"add\"\n    },\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 37,\n    vars: 17,\n    consts: [[\"action\", \"#\", \"id\", \"newRestaurant\", \"novalidate\", \"\", 1, \"mt-4\", 3, \"formGroup\", \"ngSubmit\"], [1, \"mb-3\"], [\"for\", \"name\"], [\"type\", \"text\", \"name\", \"name\", \"formControlName\", \"name\", \"placeholder\", \"Enter name\", 1, \"form-control\", 3, \"ngClass\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"for\", \"description\"], [\"id\", \"description\", \"name\", \"description\", \"formControlName\", \"description\", \"rows\", \"3\", \"placeholder\", \"Description\", 1, \"form-control\", 3, \"ngClass\"], [\"for\", \"cuisine\"], [\"type\", \"text\", \"name\", \"cuisine\", \"formControlName\", \"cuisine\", \"id\", \"cuisine\", \"placeholder\", \"Cuisine\", 1, \"form-control\", 3, \"ngClass\"], [\"class\", \"form-check form-check-inline\", \"formArrayName\", \"days\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [\"for\", \"phone\"], [\"type\", \"text\", \"id\", \"phone\", \"name\", \"phone\", \"formControlName\", \"phone\", \"pattern\", \"(\\\\+?[0-9]2 ?)?[0-9]{9}\", \"placeholder\", \"Phone number\", 1, \"form-control\", 3, \"ngClass\"], [\"for\", \"image\"], [\"type\", \"file\", \"name\", \"image\", \"formControlName\", \"image\", 1, \"form-control\", 3, \"ngClass\", \"change\"], [\"fileImage\", \"\"], [\"class\", \"img-thumbnail mb-3\", 3, \"ngClass\", \"src\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"invalid-feedback\"], [\"formArrayName\", \"days\", 1, \"form-check\", \"form-check-inline\"], [\"type\", \"checkbox\", \"name\", \"days\", 1, \"custom-control-input\", 3, \"id\", \"formControlName\", \"ngClass\"], [1, \"custom-control-label\", \"ms-2\", 3, \"for\"], [1, \"text-danger\"], [1, \"img-thumbnail\", \"mb-3\", 3, \"ngClass\", \"src\"]],\n    template: function RestaurantFormComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r13 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function RestaurantFormComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.addRestaurant();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"label\", 2);\n        i0.ɵɵtext(3, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"input\", 3);\n        i0.ɵɵtemplate(5, RestaurantFormComponent_div_5_Template, 2, 0, \"div\", 4);\n        i0.ɵɵtemplate(6, RestaurantFormComponent_div_6_Template, 2, 0, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 1)(8, \"label\", 5);\n        i0.ɵɵtext(9, \"Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(10, \"textarea\", 6);\n        i0.ɵɵtemplate(11, RestaurantFormComponent_div_11_Template, 2, 0, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"div\", 1)(13, \"label\", 7);\n        i0.ɵɵtext(14, \"Cuisine\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"input\", 8);\n        i0.ɵɵtemplate(16, RestaurantFormComponent_div_16_Template, 2, 0, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"p\");\n        i0.ɵɵtext(18, \"Opening days\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, RestaurantFormComponent_div_19_Template, 4, 5, \"div\", 9);\n        i0.ɵɵtemplate(20, RestaurantFormComponent_div_20_Template, 2, 0, \"div\", 10);\n        i0.ɵɵelementStart(21, \"div\", 1)(22, \"label\", 11);\n        i0.ɵɵtext(23, \"Phone number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"input\", 12);\n        i0.ɵɵtemplate(25, RestaurantFormComponent_div_25_Template, 2, 0, \"div\", 4);\n        i0.ɵɵtemplate(26, RestaurantFormComponent_div_26_Template, 2, 0, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"div\", 1)(28, \"label\", 13);\n        i0.ɵɵtext(29, \"Image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"input\", 14, 15);\n        i0.ɵɵlistener(\"change\", function RestaurantFormComponent_Template_input_change_30_listener() {\n          i0.ɵɵrestoreView(_r13);\n          const _r8 = i0.ɵɵreference(31);\n          return i0.ɵɵresetView(ctx.changeImage(_r8));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(32, RestaurantFormComponent_div_32_Template, 2, 0, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(33, RestaurantFormComponent_img_33_Template, 1, 4, \"img\", 16);\n        i0.ɵɵelementStart(34, \"div\")(35, \"button\", 17);\n        i0.ɵɵtext(36, \"Create\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.formRestaurant);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", ctx.validClasses(ctx.nameControl, \"is-valid\", \"is-invalid\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.nameControl.errors == null ? null : ctx.nameControl.errors[\"required\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.nameControl.errors == null ? null : ctx.nameControl.errors[\"pattern\"]);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", ctx.validClasses(ctx.descriptionControl, \"is-valid\", \"is-invalid\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.descriptionControl.errors == null ? null : ctx.descriptionControl.errors[\"required\"]);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", ctx.validClasses(ctx.cuisineControl, \"is-valid\", \"is-invalid\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.cuisineControl.errors == null ? null : ctx.cuisineControl.errors[\"required\"]);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.days);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.daysControl.errors == null ? null : ctx.daysControl.errors[\"oneChecked\"]);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", ctx.validClasses(ctx.phoneControl, \"is-valid\", \"is-invalid\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.phoneControl.errors == null ? null : ctx.phoneControl.errors[\"required\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.phoneControl.errors == null ? null : ctx.phoneControl.errors[\"pattern\"]);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngClass\", ctx.validClasses(ctx.imageControl, \"is-valid\", \"is-invalid\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.imageControl.errors == null ? null : ctx.imageControl.errors[\"required\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.newRestaurant);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.formRestaurant.invalid);\n      }\n    },\n    dependencies: [CommonModule, i4.NgClass, i4.NgForOf, i4.NgIf, FormsModule, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.PatternValidator, ReactiveFormsModule, i3.FormGroupDirective, i3.FormControlName, i3.FormArrayName],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["EventEmitter","CommonModule","FormsModule","ReactiveFormsModule","Validators","oneChecked","i0","RestaurantFormComponent","constructor","restaurantService","router","fb","name","image","cuisine","description","phone","daysOpen","ngOnInit","nameControl","control","required","pattern","descriptionControl","cuisineControl","daysControl","array","Array","fill","phoneControl","imageControl","formRestaurant","group","days","canDeactivate","saved","pristine","confirm","changeImage","fileInput","files","length","reader","FileReader","readAsDataURL","addEventListener","newRestaurant","result","fillDays","i","push","toString","addRestaurant","value","subscribe","next","imageName","navigate","error","e","console","validClasses","validClass","errorClass","touched","valid","invalid","selectors","outputs","add","standalone","features","decls","vars","consts","template","ctx","styles"],"sourceRoot":"","sources":["C:\\Users\\nesto\\OneDrive\\Escritorio\\2DAW\\DWEC\\Ejercicios\\ANGULAR\\Exercise_10\\angular-foodscore\\src\\app\\restaurants\\restaurant-form\\restaurant-form.component.ts","C:\\Users\\nesto\\OneDrive\\Escritorio\\2DAW\\DWEC\\Ejercicios\\ANGULAR\\Exercise_10\\angular-foodscore\\src\\app\\restaurants\\restaurant-form\\restaurant-form.component.html"],"sourcesContent":["import { Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Restaurant } from '../interfaces/restaurant';\nimport {\n  FormArray,\n  FormControl,\n  FormGroup,\n  FormsModule,\n  NonNullableFormBuilder,\n  ReactiveFormsModule,\n  Validators,\n} from '@angular/forms';\nimport { RestaurantsService } from '../services/restaurant-service.service';\nimport { Router } from '@angular/router';\nimport { CanDeactivateComponent } from 'src/app/guards/leave-page-guard.guard';\nimport { oneChecked } from '../validators/minDays.validator';\n\n@Component({\n  selector: 'fs-restaurant-form',\n  standalone: true,\n  imports: [CommonModule, FormsModule, ReactiveFormsModule],\n  templateUrl: './restaurant-form.component.html',\n  styleUrls: ['./restaurant-form.component.css'],\n})\nexport class RestaurantFormComponent implements OnInit, CanDeactivateComponent {\n  @Output() add = new EventEmitter<Restaurant>();\n\n  newRestaurant: Restaurant = {\n    name: \"\",\n    image: \"\",\n    cuisine: \"\",\n    description: \"\",\n    phone: \"\",\n    daysOpen: [],\n  };\n  imageName = '';\n  readonly days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n\n  saved = false;\n  formRestaurant!: FormGroup;\n  nameControl!: FormControl<string>;\n  descriptionControl!: FormControl<string>;\n  cuisineControl!: FormControl<string>;\n  daysControl!: FormArray;\n  phoneControl!: FormControl<string>;\n  imageControl!: FormControl<string>;\n\n  constructor(\n    private readonly restaurantService: RestaurantsService,\n    private readonly router: Router,\n    private fb: NonNullableFormBuilder\n  ) {}\n\n  ngOnInit(): void {\n    this.nameControl = this.fb.control('', [\n      Validators.required,\n      Validators.pattern('^[a-zA-Z][a-zA-Z ]*$'),\n    ]);\n\n    this.descriptionControl = this.fb.control('', [\n      Validators.required,\n    ]);\n\n    this.cuisineControl = this.fb.control('', [\n      Validators.required,\n    ]);\n\n    this.daysControl = this.fb.array(new Array(7).fill(true), [\n      oneChecked(),\n    ]);\n\n    this.phoneControl = this.fb.control('', [\n      Validators.required,\n      Validators.pattern('([+0]?[0-9]{2} ?)?[0-9]{9}'),\n    ]);\n\n    this.imageControl = this.fb.control('', [Validators.required]);\n\n    this.formRestaurant = this.fb.group({\n      name: this.nameControl,\n      description: this.descriptionControl,\n      cuisine: this.cuisineControl,\n      days: this.daysControl,\n      phone: this.phoneControl,\n      image: this.imageControl,\n    });\n  }\n\n  canDeactivate() {\n    return (\n      this.saved ||\n      this.formRestaurant.pristine ||\n      confirm('Do you want to leave this page?. Changes can be lost')\n    );\n  }\n\n  changeImage(fileInput: HTMLInputElement) {\n    if (!fileInput.files || fileInput.files.length === 0) {\n      return;\n    }\n    const reader: FileReader = new FileReader();\n    reader.readAsDataURL(fileInput.files[0]);\n    reader.addEventListener('loadend', () => {\n      this.newRestaurant.image = reader.result as string;\n    });\n  }\n\n  fillDays(daysOpen: boolean[]): string[] {\n    const result: string[] = [];\n    for (let i = 0; i < daysOpen.length; i++) {\n      if (daysOpen[i]) {\n        result.push(i.toString());\n      }\n    }\n    return result;\n  }\n\n  addRestaurant() {\n    this.newRestaurant.name = this.nameControl.value;\n    this.newRestaurant.description = this.descriptionControl.value;\n    this.newRestaurant.cuisine = this.cuisineControl.value;\n    this.newRestaurant.daysOpen = this.fillDays(this.daysControl.value);\n    this.newRestaurant.phone = this.phoneControl.value;\n\n    this.restaurantService.addRestaurant(this.newRestaurant).subscribe({\n      next: () => {\n        this.saved = true;\n        this.imageName = '';\n        this.router.navigate(['/restaurant']);\n      },\n      error: (e) => console.error(e),\n    });\n  }\n\n  validClasses(control: FormControl | FormArray, validClass: string, errorClass: string) {\n    return {\n      [validClass]: control.touched && control.valid,\n      [errorClass]: control.touched && control.invalid,\n    };\n  }\n}\n","<form\n  action=\"#\"\n  class=\"mt-4\"\n  id=\"newRestaurant\"\n  novalidate\n  [formGroup]=\"formRestaurant\"\n  (ngSubmit)=\"addRestaurant()\"\n>\n  <div class=\"mb-3\">\n    <label for=\"name\">Name</label>\n    <input\n      type=\"text\"\n      class=\"form-control\"\n      name=\"name\"\n      formControlName=\"name\"\n      placeholder=\"Enter name\"\n      [ngClass]=\"validClasses(nameControl, 'is-valid', 'is-invalid')\"\n    />\n    <div class=\"invalid-feedback\" *ngIf=\"nameControl.errors?.['required']\">\n      Name is required.\n    </div>\n    <div class=\"invalid-feedback\" *ngIf=\"nameControl.errors?.['pattern']\">\n      Name can only contain letters and spaces.\n    </div>\n  </div>\n  <div class=\"mb-3\">\n    <label for=\"description\">Description</label>\n    <textarea\n      class=\"form-control\"\n      id=\"description\"\n      name=\"description\"\n      formControlName=\"description\"\n      rows=\"3\"\n      placeholder=\"Description\"\n      [ngClass]=\"validClasses(descriptionControl, 'is-valid', 'is-invalid')\"\n    ></textarea>\n    <div\n      class=\"invalid-feedback\"\n      *ngIf=\"descriptionControl.errors?.['required']\"\n    >\n      Description is required.\n    </div>\n  </div>\n  <div class=\"mb-3\">\n    <label for=\"cuisine\">Cuisine</label>\n    <input\n      type=\"text\"\n      class=\"form-control\"\n      name=\"cuisine\"\n      formControlName=\"cuisine\"\n      id=\"cuisine\"\n      placeholder=\"Cuisine\"\n      [ngClass]=\"validClasses(cuisineControl, 'is-valid', 'is-invalid')\"\n    />\n    <div class=\"invalid-feedback\" *ngIf=\"cuisineControl.errors?.['required']\">\n      Cuisine is required.\n    </div>\n  </div>\n  <p>Opening days</p>\n  <div\n    class=\"form-check form-check-inline\"\n    *ngFor=\"let day of days; let i = index\"\n    formArrayName=\"days\"\n  >\n    <input\n      type=\"checkbox\"\n      class=\"custom-control-input\"\n      id=\"checkDay{{ i }}\"\n      name=\"days\"\n      [formControlName]=\"i\"\n      [ngClass]=\"validClasses(daysControl, 'is-valid', 'is-invalid')\"\n    />\n    <label class=\"custom-control-label ms-2\" for=\"checkDay{{ i }}\">{{\n      day\n    }}</label>\n  </div>\n  <div class=\"text-danger\" *ngIf=\"daysControl.errors?.['oneChecked']\">\n    A minimum of one day is required.\n  </div>\n  <div class=\"mb-3\">\n    <label for=\"phone\">Phone number</label>\n    <input\n      type=\"text\"\n      class=\"form-control\"\n      id=\"phone\"\n      name=\"phone\"\n      formControlName=\"phone\"\n      pattern=\"(\\+?[0-9]2 ?)?[0-9]{9}\"\n      placeholder=\"Phone number\"\n      [ngClass]=\"validClasses(phoneControl, 'is-valid', 'is-invalid')\"\n    />\n    <div class=\"invalid-feedback\" *ngIf=\"phoneControl.errors?.['required']\">\n      Phone is required.\n    </div>\n    <div class=\"invalid-feedback\" *ngIf=\"phoneControl.errors?.['pattern']\">\n      Phone must have 9 numbers.\n    </div>\n  </div>\n  <div class=\"mb-3\">\n    <label for=\"image\">Image</label>\n    <input\n      type=\"file\"\n      class=\"form-control\"\n      #fileImage\n      (change)=\"changeImage(fileImage)\"\n      name=\"image\"\n      formControlName=\"image\"\n      [ngClass]=\"validClasses(imageControl, 'is-valid', 'is-invalid')\"\n    />\n    <div class=\"invalid-feedback\" *ngIf=\"imageControl.errors?.['required']\">\n      Image is required.\n    </div>\n  </div>\n  <img\n    [ngClass]=\"{ 'd-none': !newRestaurant.image }\"\n    class=\"img-thumbnail mb-3\"\n    *ngIf=\"newRestaurant\"\n    [src]=\"newRestaurant.image\"\n  />\n  <div>\n    <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"formRestaurant.invalid\">Create</button> <!--  -->\n  </div>\n</form>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}